<% include partials/head %>
<%- include('partials/header', {path: 'challenge', nomChallenge: nomChallenge, connected: 'ok'}) %>

<body>
    <div class="container">
        <br>
        <h3>Description  <% if (validate) { %>
            <img id="img" src="/images/green-check-circle.png" alt="" width="20px">
            <%}
            else {%>
            <img id="img" src="/images/red-cross-circle.png" alt="" width="20px">
            <%}%></h3>

        <p><%= description %></p>
        <a class="btn btn-secondary" target="_blank" href="http://<%= host %>/<%= idChallenge %>" role="button">Démarrer le challenge</a>

        <br><br><br>

        <h3>Validation</h3>
        <div class="form-group">
            <label for="flagInput">Entrez le flag de validation</label>
            <input type="text" class="form-control" name="flagInput" id="flagInput" placeholder="flag">
        </div>
        <button type="button" id="flagSubmit" class="btn btn-secondary">Envoyer</button>

        <br><br>
        <div class="alert alert-success" role="alert" id="goodFlag" style="display: none;">
            Bravo vous avez trouvé le flag !
        </div>
        <div class="alert alert-danger" role="alert" id="wrongFlag" style="display: none;">
            Ce n'est pas le bon flag, accrochez-vous !
        </div>
        <div class="alert alert-danger" role="alert" id="emptyFlag" style="display: none;">
            Veuillez renseigner un flag !
        </div>
        <br>

        <% if (indice != "") {%>
            <h3>Aide</h3>
            <button class="btn btn-secondary" id="voirIndice" role="button">Voir l'indice</button>
            <div id="indiceDiv" style="display:none">
                <p style="margin-bottom: -30px; margin-top:15px;"><%= indice %></p>
            </div>
        <br><br><br>
        <%}%>


        <h3>Solution</h3>
        <p> Voir les solutions du challenge</p>
        <button class="btn btn-secondary" id="voirSolution" role="button">Voir les solutions</button>

        <br>
        <br>

        <!-- Alerte JS -->
        <div id="pasDroitAcces" style="display: none">
            <div class="alert alert-danger" role="alert">
                Il faut d'abord valider le challenge pour avoir accès à la solution !
            </div>
        </div>

        <div style="display: none;" id="divSolution">
            <p id="solutionText"></p>
        </div>

        <div id="divProposer"<% if (!validate) {%> style="display:none;" <%}%>>
            <br>
            <h3>Proposer une solution</h3>
            <button class="btn btn-secondary" id="proposerSolution" role="button">Proposer</button>
            <textarea class="form-control" id="solutionTextArea" rows="3" style="display:none;"></textarea>
            <br>
            <button class="btn btn-secondary" id="envoyerSolution" role="button" style="display:none;">Envoyer</button>
        </div>

        <!-- Alerte JS -->
        <div id="solutionProposeeSuccess" style="display: none">
            <br>
            <div class="alert alert-success" role="alert">
                Merci d'avoir proposé une solution pour ce challenge !
            </div>
        </div>

        <div id="solutionProposeeFail" style="display: none">
            <br>
            <div class="alert alert-danger" role="alert">
                <label style="margin-bottom: 0px;" id="message"></label>
            </div>
        </div>

        <p style="display: none;" id="pId" ><%= idChallenge %></p>
        <script src="/js/challenge.js"></script>

    </div>
</body>
<% include partials/footer %>